info:
  name: smartermail_cve_2025_52691_vuln
  author: Fayzulla Saurov
  severity: 10
  description: "CVE-2025-52691 - Unauthenticated Arbitrary File Upload RCE in SmarterMail. Path traversal vulnerability allows attackers to upload malicious files to arbitrary locations, leading to remote code execution. Affects SmarterMail versions prior to Build 9511. CVSS 10.0 Critical."
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-52691
    - https://labs.watchtowr.com/do-smart-people-ever-say-theyre-smart-smartertools-smartermail-pre-auth-rce-cve-2025-52691/
    - https://www.cisa.gov/known-exploited-vulnerabilities-catalog
  profiles:
    - vuln
    - http
    - critical_severity
    - cve
    - smartermail
    - file_upload

payloads:
  - library: http
    steps:
      - method: get
        timeout: 10
        headers:
          User-Agent: "{user_agent}"
        allow_redirects: false
        ssl: false
        url:
          nettacker_fuzzer:
            input_format: "{{schema}}://{target}:{{ports}}/Interface/Settings/Default.aspx"
            prefix: ""
            suffix: ""
            interceptors:
            data:
              schema:
                - "http"
                - "https"
              ports:
                - 80
                - 443
                - 9998
                - 9999
        response:
          condition_type: or
          conditions:
            status_code:
              regex: "200|302|401|403"
              reverse: false
            content:
              regex: "SmarterMail|Settings|Interface|FileUpload|aspx"
              reverse: false
